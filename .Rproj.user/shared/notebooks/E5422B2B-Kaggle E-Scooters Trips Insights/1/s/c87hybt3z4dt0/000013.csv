"0","percentage = function(a,b){"
"0","   return (round((a/b),2))"
"0","}"
"0",""
"0",""
"0","data_mod= data |> group_by(Start.Community.Area.Name,"
"0","                 Start.Centroid.Latitude,"
"0","                 Start.Centroid.Longitude,"
"0","                 Vendor) |>"
"0","      summarise(n=n()) |>"
"0","      na.omit() |>"
"0","      pivot_wider(names_from='Vendor',values_from=n) |> "
"0","      mutate(total=bird+lime+spin) |> "
"0","      mutate(p.bird=percentage(bird,total),p.lime=percentage(lime,total),p.spin=percentage(spin,total))"
"2","`summarise()` has grouped output by 'Start.Community.Area.Name', 'Start.Centroid.Latitude', 'Start.Centroid.Longitude'. You can override using the `.groups` argument."
"0","   "
"0",""
"0","basemap = leaflet() %>% "
"0","   addTiles() %>% "
"0","   addProviderTiles(providers$OpenStreetMap)"
"0",""
"0","basemap |> "
"0","addMinicharts("
"0","   lat=data_mod$Start.Centroid.Latitude, lng=data_mod$Start.Centroid.Longitude,"
"0","   type = ""pie"","
"0","   chartdata = data_mod[,c('p.bird','p.lime','p.spin')],"
"0","   width =40 * sqrt(data_mod$total) / sqrt(max(data_mod$total)),"
"0","   layerId =data_mod$Start.Community.Area.Name,"
"0","   colorPalette = brewer.pal(3,""Dark2"")"
"0","   "
"0","   )"
